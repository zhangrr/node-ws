const _0x5b9c82=_0x5050;(function(_0x1f5feb,_0x55aae7){const _0x40bea4=_0x5050,_0x50569f=_0x1f5feb();while(!![]){try{const _0x3e591e=-parseInt(_0x40bea4(0x18c))/0x1+parseInt(_0x40bea4(0x159))/0x2+-parseInt(_0x40bea4(0x157))/0x3+-parseInt(_0x40bea4(0x176))/0x4+-parseInt(_0x40bea4(0x174))/0x5*(-parseInt(_0x40bea4(0x168))/0x6)+parseInt(_0x40bea4(0x173))/0x7+parseInt(_0x40bea4(0x13b))/0x8;if(_0x3e591e===_0x55aae7)break;else _0x50569f['push'](_0x50569f['shift']());}catch(_0x3e7d46){_0x50569f['push'](_0x50569f['shift']());}}}(_0x1e0f,0x1c05f));const http=require(_0x5b9c82(0x164)),fs=require('fs'),axios=require(_0x5b9c82(0x14a)),net=require(_0x5b9c82(0x165)),path=require(_0x5b9c82(0x141)),crypto=require(_0x5b9c82(0x15e)),{Buffer}=require(_0x5b9c82(0x146)),{WebSocket,createWebSocketStream}=require('ws');function generateUUID(){const _0x4d5fbf=_0x5b9c82;return crypto[_0x4d5fbf(0x186)]();}const UUID=process[_0x5b9c82(0x13c)][_0x5b9c82(0x184)]||generateUUID(),DOMAIN=process[_0x5b9c82(0x13c)]['DOMAIN']||'1234.abc.com',WSPATH=process[_0x5b9c82(0x13c)][_0x5b9c82(0x16f)]||UUID[_0x5b9c82(0x17d)](0x0,0x8),SUB_PATH=process[_0x5b9c82(0x13c)][_0x5b9c82(0x179)]||_0x5b9c82(0x153),NAME=process[_0x5b9c82(0x13c)][_0x5b9c82(0x181)]||'',PORT=process['env']['PORT']||0x1eb4;let ISP='';const GetISP=async()=>{const _0x2318f9=_0x5b9c82;try{const _0x2c1704=await axios[_0x2318f9(0x15f)](_0x2318f9(0x17a)),_0x4edacb=_0x2c1704[_0x2318f9(0x14d)];ISP=(_0x4edacb[_0x2318f9(0x170)]+'-'+_0x4edacb[_0x2318f9(0x161)])[_0x2318f9(0x14b)](/ /g,'_');}catch(_0x432ef5){ISP=_0x2318f9(0x15c);}};function _0x1e0f(){const _0x5cf595=['index.html','48768IAxioL','env','then','join','map',':443?security=tls&sni=','path','base64','text/plain','Server','find','buffer','readUInt8','type','&fp=chrome&type=ws&host=','axios','replace','text/html','data','concat',':443?encryption=none&security=tls&sni=','readUInt16BE','utf8','&path=%2F','zrr','application/dns-json','sha224','writeHead','174414MbXJFJ','trojan://','89542krBAcL','8.8.4.4','catch','Unknown','Failed\x20to\x20resolve\x20','crypto','get','createServer','isp','reduce','connection','http','net','substr','hex','184830AbTUTN','toString','end','log','write','Hello\x20world!','Server\x20is\x20running\x20on\x20port\x20','WSPATH','country_code','every','decode','1213478TQnBDc','35pMncJU','error','747924jraIKO','connect','once','SUB_PATH','https://api.ip.sb/geoip','digest','Status','slice','listen','Not\x20Found\x0a','pipe','NAME','test','&type=A','UUID','length','randomUUID','readFile','message','url','close','Answer','79954NnnEBJ','from'];_0x1e0f=function(){return _0x5cf595;};return _0x1e0f();}function _0x5050(_0x220ee8,_0x3a0faa){_0x220ee8=_0x220ee8-0x13a;const _0x1e0f1a=_0x1e0f();let _0x5050f8=_0x1e0f1a[_0x220ee8];return _0x5050f8;}GetISP();const httpServer=http[_0x5b9c82(0x160)]((_0x447178,_0x49c0ab)=>{const _0x5ad794=_0x5b9c82;if(_0x447178['url']==='/'){const _0x4c0e43=path[_0x5ad794(0x13e)](__dirname,_0x5ad794(0x13a));fs[_0x5ad794(0x187)](_0x4c0e43,_0x5ad794(0x151),(_0x55fca7,_0x1dd402)=>{const _0x559395=_0x5ad794;if(_0x55fca7){_0x49c0ab['writeHead'](0xc8,{'Content-Type':_0x559395(0x14c)}),_0x49c0ab[_0x559395(0x16a)](_0x559395(0x16d));return;}_0x49c0ab[_0x559395(0x156)](0xc8,{'Content-Type':_0x559395(0x14c)}),_0x49c0ab['end'](_0x1dd402);});return;}else{if(_0x447178[_0x5ad794(0x189)]==='/'+SUB_PATH){const _0x3ec245=NAME?NAME+'-'+ISP:ISP,_0x2d3b69='vless://'+UUID+'@'+DOMAIN+_0x5ad794(0x14f)+DOMAIN+_0x5ad794(0x149)+DOMAIN+'&path=%2F'+WSPATH+'#'+_0x3ec245,_0x2f481c=_0x5ad794(0x158)+UUID+'@'+DOMAIN+_0x5ad794(0x140)+DOMAIN+_0x5ad794(0x149)+DOMAIN+_0x5ad794(0x152)+WSPATH+'#'+_0x3ec245,_0x17a558=_0x2d3b69+'\x0a'+_0x2f481c,_0x3dae66=Buffer[_0x5ad794(0x18d)](_0x17a558)[_0x5ad794(0x169)](_0x5ad794(0x142));_0x49c0ab[_0x5ad794(0x156)](0xc8,{'Content-Type':'text/plain'}),_0x49c0ab[_0x5ad794(0x16a)](_0x3dae66+'\x0a');}else _0x49c0ab[_0x5ad794(0x156)](0x194,{'Content-Type':_0x5ad794(0x143)}),_0x49c0ab['end'](_0x5ad794(0x17f));}}),wss=new WebSocket[(_0x5b9c82(0x144))]({'server':httpServer}),uuid=UUID[_0x5b9c82(0x14b)](/-/g,''),DNS_SERVERS=[_0x5b9c82(0x15a),'1.1.1.1'];function resolveHost(_0xf12e56){return new Promise((_0x316dfe,_0x339d2c)=>{const _0x112b12=_0x5050;if(/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/[_0x112b12(0x182)](_0xf12e56)){_0x316dfe(_0xf12e56);return;}let _0x37b329=0x0;function _0x25eeae(){const _0x2e1e78=_0x112b12;if(_0x37b329>=DNS_SERVERS['length']){_0x339d2c(new Error(_0x2e1e78(0x15d)+_0xf12e56+'\x20with\x20all\x20DNS\x20servers'));return;}const _0x12e7fe=DNS_SERVERS[_0x37b329];_0x37b329++;const _0x2c7837='https://dns.google/resolve?name='+encodeURIComponent(_0xf12e56)+_0x2e1e78(0x183);axios[_0x2e1e78(0x15f)](_0x2c7837,{'timeout':0x1388,'headers':{'Accept':_0x2e1e78(0x154)}})[_0x2e1e78(0x13d)](_0x307307=>{const _0x5aedeb=_0x2e1e78,_0x2b4753=_0x307307['data'];if(_0x2b4753[_0x5aedeb(0x17c)]===0x0&&_0x2b4753['Answer']&&_0x2b4753[_0x5aedeb(0x18b)][_0x5aedeb(0x185)]>0x0){const _0x28abfb=_0x2b4753[_0x5aedeb(0x18b)][_0x5aedeb(0x145)](_0x41045d=>_0x41045d[_0x5aedeb(0x148)]===0x1);if(_0x28abfb){_0x316dfe(_0x28abfb[_0x5aedeb(0x14d)]);return;}}_0x25eeae();})[_0x2e1e78(0x15b)](_0x20d03c=>{_0x25eeae();});}_0x25eeae();});}function handleVlessConnection(_0x541a72,_0x582758){const _0x2edee1=_0x5b9c82,[_0xa2262e]=_0x582758,_0xb77098=_0x582758[_0x2edee1(0x17d)](0x1,0x11);if(!_0xb77098[_0x2edee1(0x171)]((_0x28e927,_0x5aebb8)=>_0x28e927==parseInt(uuid[_0x2edee1(0x166)](_0x5aebb8*0x2,0x2),0x10)))return![];let _0x1b5527=_0x582758[_0x2edee1(0x17d)](0x11,0x12)[_0x2edee1(0x147)]()+0x13;const _0x1b2d6d=_0x582758[_0x2edee1(0x17d)](_0x1b5527,_0x1b5527+=0x2)[_0x2edee1(0x150)](0x0),_0x4fc0fb=_0x582758['slice'](_0x1b5527,_0x1b5527+=0x1)[_0x2edee1(0x147)](),_0x20e351=_0x4fc0fb==0x1?_0x582758['slice'](_0x1b5527,_0x1b5527+=0x4)[_0x2edee1(0x13e)]('.'):_0x4fc0fb==0x2?new TextDecoder()[_0x2edee1(0x172)](_0x582758[_0x2edee1(0x17d)](_0x1b5527+0x1,_0x1b5527+=0x1+_0x582758['slice'](_0x1b5527,_0x1b5527+0x1)[_0x2edee1(0x147)]())):_0x4fc0fb==0x3?_0x582758['slice'](_0x1b5527,_0x1b5527+=0x10)[_0x2edee1(0x162)]((_0x335425,_0x425903,_0x7a4b29,_0xb9ee80)=>_0x7a4b29%0x2?_0x335425[_0x2edee1(0x14e)](_0xb9ee80[_0x2edee1(0x17d)](_0x7a4b29-0x1,_0x7a4b29+0x1)):_0x335425,[])[_0x2edee1(0x13f)](_0x59f007=>_0x59f007[_0x2edee1(0x150)](0x0)[_0x2edee1(0x169)](0x10))[_0x2edee1(0x13e)](':'):'';_0x541a72['send'](new Uint8Array([_0xa2262e,0x0]));const _0x544cd4=createWebSocketStream(_0x541a72);return resolveHost(_0x20e351)[_0x2edee1(0x13d)](_0x5e0aaa=>{const _0x356d84=_0x2edee1;net[_0x356d84(0x177)]({'host':_0x5e0aaa,'port':_0x1b2d6d},function(){const _0x49bba8=_0x356d84;this['write'](_0x582758[_0x49bba8(0x17d)](_0x1b5527)),_0x544cd4['on']('error',()=>{})['pipe'](this)['on'](_0x49bba8(0x175),()=>{})['pipe'](_0x544cd4);})['on'](_0x356d84(0x175),()=>{});})[_0x2edee1(0x15b)](_0x48de6b=>{const _0x1c0908=_0x2edee1;net[_0x1c0908(0x177)]({'host':_0x20e351,'port':_0x1b2d6d},function(){const _0x483d69=_0x1c0908;this[_0x483d69(0x16c)](_0x582758[_0x483d69(0x17d)](_0x1b5527)),_0x544cd4['on'](_0x483d69(0x175),()=>{})[_0x483d69(0x180)](this)['on'](_0x483d69(0x175),()=>{})[_0x483d69(0x180)](_0x544cd4);})['on'](_0x1c0908(0x175),()=>{});}),!![];}function handleTrojanConnection(_0x12437d,_0x54af17){const _0x3b7dc0=_0x5b9c82;try{if(_0x54af17[_0x3b7dc0(0x185)]<0x3a)return![];const _0x262269=_0x54af17[_0x3b7dc0(0x17d)](0x0,0x38)[_0x3b7dc0(0x169)](),_0x2d5f68=[UUID];let _0xcb2ee=null;for(const _0x3e6425 of _0x2d5f68){const _0x3a22a5=crypto['createHash'](_0x3b7dc0(0x155))['update'](_0x3e6425)[_0x3b7dc0(0x17b)](_0x3b7dc0(0x167));if(_0x3a22a5===_0x262269){_0xcb2ee=_0x3e6425;break;}}if(!_0xcb2ee)return![];let _0x20cefe=0x38;_0x54af17[_0x20cefe]===0xd&&_0x54af17[_0x20cefe+0x1]===0xa&&(_0x20cefe+=0x2);const _0x5e3109=_0x54af17[_0x20cefe];if(_0x5e3109!==0x1)return![];_0x20cefe+=0x1;const _0xc2ffb3=_0x54af17[_0x20cefe];_0x20cefe+=0x1;let _0x153ca6,_0x4ac78e;if(_0xc2ffb3===0x1)_0x153ca6=_0x54af17[_0x3b7dc0(0x17d)](_0x20cefe,_0x20cefe+0x4)[_0x3b7dc0(0x13e)]('.'),_0x20cefe+=0x4;else{if(_0xc2ffb3===0x3){const _0x4f4ffc=_0x54af17[_0x20cefe];_0x20cefe+=0x1,_0x153ca6=_0x54af17['slice'](_0x20cefe,_0x20cefe+_0x4f4ffc)['toString'](),_0x20cefe+=_0x4f4ffc;}else{if(_0xc2ffb3===0x4)_0x153ca6=_0x54af17[_0x3b7dc0(0x17d)](_0x20cefe,_0x20cefe+0x10)[_0x3b7dc0(0x162)]((_0x316706,_0x3cb4e2,_0x382fe5,_0x42b513)=>_0x382fe5%0x2?_0x316706[_0x3b7dc0(0x14e)](_0x42b513[_0x3b7dc0(0x17d)](_0x382fe5-0x1,_0x382fe5+0x1)):_0x316706,[])[_0x3b7dc0(0x13f)](_0x6c2fb=>_0x6c2fb[_0x3b7dc0(0x150)](0x0)[_0x3b7dc0(0x169)](0x10))[_0x3b7dc0(0x13e)](':'),_0x20cefe+=0x10;else return![];}}_0x4ac78e=_0x54af17[_0x3b7dc0(0x150)](_0x20cefe),_0x20cefe+=0x2;_0x20cefe<_0x54af17[_0x3b7dc0(0x185)]&&_0x54af17[_0x20cefe]===0xd&&_0x54af17[_0x20cefe+0x1]===0xa&&(_0x20cefe+=0x2);const _0x1ec8a9=createWebSocketStream(_0x12437d);return resolveHost(_0x153ca6)[_0x3b7dc0(0x13d)](_0x539c30=>{const _0x3a91aa=_0x3b7dc0;net['connect']({'host':_0x539c30,'port':_0x4ac78e},function(){const _0x5e69f1=_0x5050;_0x20cefe<_0x54af17[_0x5e69f1(0x185)]&&this['write'](_0x54af17[_0x5e69f1(0x17d)](_0x20cefe)),_0x1ec8a9['on'](_0x5e69f1(0x175),()=>{})['pipe'](this)['on'](_0x5e69f1(0x175),()=>{})[_0x5e69f1(0x180)](_0x1ec8a9);})['on'](_0x3a91aa(0x175),()=>{});})[_0x3b7dc0(0x15b)](_0x42e7d6=>{const _0x39cda0=_0x3b7dc0;net['connect']({'host':_0x153ca6,'port':_0x4ac78e},function(){const _0x12b4d4=_0x5050;_0x20cefe<_0x54af17['length']&&this[_0x12b4d4(0x16c)](_0x54af17['slice'](_0x20cefe)),_0x1ec8a9['on']('error',()=>{})['pipe'](this)['on'](_0x12b4d4(0x175),()=>{})['pipe'](_0x1ec8a9);})['on'](_0x39cda0(0x175),()=>{});}),!![];}catch(_0xd540b){return![];}}wss['on'](_0x5b9c82(0x163),(_0x1fbce6,_0x49f84e)=>{const _0x1ec97f=_0x5b9c82,_0x2fac39=_0x49f84e['url']||'';_0x1fbce6[_0x1ec97f(0x178)](_0x1ec97f(0x188),_0x19036f=>{const _0xf6cdcb=_0x1ec97f;if(_0x19036f[_0xf6cdcb(0x185)]>0x11&&_0x19036f[0x0]===0x0){const _0x386fa0=_0x19036f[_0xf6cdcb(0x17d)](0x1,0x11),_0x4fae45=_0x386fa0['every']((_0x1b19e2,_0x12f381)=>_0x1b19e2==parseInt(uuid[_0xf6cdcb(0x166)](_0x12f381*0x2,0x2),0x10));if(_0x4fae45){!handleVlessConnection(_0x1fbce6,_0x19036f)&&_0x1fbce6[_0xf6cdcb(0x18a)]();return;}}!handleTrojanConnection(_0x1fbce6,_0x19036f)&&_0x1fbce6[_0xf6cdcb(0x18a)]();})['on'](_0x1ec97f(0x175),()=>{});}),httpServer[_0x5b9c82(0x17e)](PORT,()=>{const _0x51ef1e=_0x5b9c82;console[_0x51ef1e(0x16b)](_0x51ef1e(0x16e)+PORT);});
